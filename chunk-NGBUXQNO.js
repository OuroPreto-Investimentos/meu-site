import{c as v,d as y,e as g,i as I,m as c,n as b}from"./chunk-EDD3CIRD.js";import{a as p}from"./chunk-EYABK2KV.js";import{a as f}from"./chunk-Q7HPRWHR.js";import{H as d,L as U,a as o,aa as a,b as u,da as i,ia as n,oa as s,s as h,t as m,w as k}from"./chunk-HPC372FG.js";var T=e=>{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map(function(w){return"%"+("00"+w.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)};var x=(()=>{class e{constructor(){this.httpClient=s(f)}getUnique(t){return this.httpClient.get(`${p.apiUrl}User/get/unique/${t}`).pipe(k(r=>r.model),i(r=>{localStorage.setItem("currentUser",JSON.stringify(r))}),d(r=>(console.error("Error in getUnique:",r),m(()=>r))))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var C=(()=>{class e{getToken(){return this.token}setToken(t){localStorage.setItem("postToken",t)}deleteToken(){localStorage.removeItem("postToken"),localStorage.removeItem("postUser")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var _=(()=>{class e{constructor(){this.httpClient=s(f),this.tokenService=s(C),this.userService=s(x)}login(t){return this.httpClient.post(`${p.apiUrl}Authentication/login`,t).pipe(i(r=>this.tokenService.setToken(r.model)),a(()=>this.getToken()),d(r=>m(()=>r)))}getToken(){return this.httpClient.post(`${p.apiUrl}Authentication/GetToken`,null).pipe(i(t=>{this.tokenService.setToken(t.model)}),a(t=>this.parseUser(t.model)),a(()=>h(null)))}getAndSetUniqueUser(t){return this.userService.getUnique(t).pipe(i(r=>this.setUser(r)))}setUser(t){localStorage.setItem("postUser",JSON.stringify(t))}parseUser(t){let r=T(t);return this.getAndSetUniqueUser(r.UserId).pipe(U(1),a(()=>h(null)))}getCurrentUser(){this.getAndSetUniqueUser(this.currentUser.id).pipe(U(1)).subscribe(t=>{})}logout(){this.tokenService.deleteToken()}get currentUser(){let t=localStorage.getItem("postUser");return t?JSON.parse(t):null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var l=y({source:"Layout",events:{setData:v(),toggleTheme:g(),toggleSidebar:g(),loading:g()}});var q={sidebar:!1,isDarkMode:!1,loading:!1},A=I({name:"layout",reducer:b(q,c(l.setData,(e,{data:S})=>o(o({},e),S)),c(l.toggleTheme,e=>u(o({},e),{isDarkMode:!e.isDarkMode})),c(l.toggleSidebar,e=>u(o({},e),{sidebar:!e.sidebar})),c(l.loading,e=>u(o({},e),{loading:!e.loading})))});var{selectLayoutState:D,selectIsDarkMode:F,selectSidebar:J,selectLoading:E}=A,ce={selectLayoutState:D,selectIsDarkMode:F,selectSidebar:J,selectLoading:E};export{_ as a,l as b,A as c,ce as d};
