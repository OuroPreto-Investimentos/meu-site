import{c as m,d as u,e as F,g as S,h as g,i as d,m as n,n as E}from"./chunk-EDD3CIRD.js";import{a as l}from"./chunk-EYABK2KV.js";import{a as y}from"./chunk-Q7HPRWHR.js";import{a as o,b as i,da as v,ia as D,oa as C,s as x,w as h}from"./chunk-HPC372FG.js";var p=u({source:"Kanban",events:{setData:m(),setColumns:e=>({columns:e}),setContext:e=>({context:e}),setSelectedItem:e=>({selectedItem:e}),setFilters:m()}});var a=u({source:"Redmine",events:{setData:m(),setIssues:e=>({issues:e}),setVersions:e=>({versions:e}),getIssues:F()}});var c=function(e){return e[e.NEW=1]="NEW",e[e.IN_PROGRESS=2]="IN_PROGRESS",e[e.RESOLVED=3]="RESOLVED",e[e.FEEDBACK=4]="FEEDBACK",e[e.CLOSED=5]="CLOSED",e[e.REJECTED=6]="REJECTED",e}(c||{}),N=[{id:c.NEW,name:"Novo",color:"52, 152, 219"},{id:c.IN_PROGRESS,name:"Em progresso",color:"230, 126, 34"},{id:c.RESOLVED,name:"Resolvido",color:"46, 204, 113"},{id:c.FEEDBACK,name:"Feedback",color:"155, 89, 182"},{id:c.CLOSED,name:"Fechado",color:"149, 165, 166"}];function A(e){return Object.keys(e).reduce((t,s)=>{let r=e[s];return r==null||(typeof r=="object"&&!Array.isArray(r)?t[s]=A(r):t[s]=r),t},{})}var ee=(()=>{class e{constructor(){this.store=C(S),this.httpClient=C(y)}getOpenVersions(s=!1){let r={allVersions:s};return this.httpClient.get(`${l.apiUrl}Redmine/versions`,{params:r}).pipe(h(f=>f.model.filter(I=>I.status==="open")))}getIssues({version:s,assignedToId:r,trackerId:f,statusId:I="*",priorityId:R}){let b=A({version:s,assigned_to_id:r,tracker_id:f,status_id:I,priority_id:R});return this.httpClient.get(`${l.apiUrl}Redmine/issues`,{params:o({},b)}).pipe(h(k=>k.model))}create(s){return this.httpClient.post(`${l.apiUrl}Redmine/issues/`,s).pipe(v(()=>{this.store.dispatch(a.getIssues())}))}updateIssues(s,r){return this.httpClient.put(`${l.apiUrl}Redmine/issues/${s}`,r,{responseType:"text"}).pipe(v(()=>{this.store.dispatch(a.getIssues())}))}getColumns(){return x(N)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=D({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var U={items:[],filteredItems:[],selectedItem:null,title:"",context:"task",columns:[]},ne=d({name:"kanban",reducer:E(U,n(p.setData,(e,{data:t})=>o(o({},e),t)),n(p.setColumns,(e,{columns:t})=>i(o({},e),{columns:t})),n(p.setContext,(e,{context:t})=>i(o({},e),{context:t})),n(p.setSelectedItem,(e,{selectedItem:t})=>i(o({},e),{selectedItem:t})),n(p.setFilters,(e,{filters:t})=>i(o({},e),{filteredItems:e.items.filter(s=>(t??[]).every(r=>Array.isArray(r.value)&&r.value.length===0?!0:Array.isArray(r.value)?r.value.includes(s[r.key]):s[r.key]===r.value))})))});var _={issues:[],versions:[]},O=d({name:"redmine",reducer:E(_,n(a.setData,(e,{data:t})=>o(o({},e),t)),n(a.setIssues,(e,{issues:t})=>i(o({},e),{issues:t})),n(a.setVersions,(e,{versions:t})=>i(o({},e),{versions:t})))});var{selectRedmineState:T,selectIssues:V,selectVersions:L}=O,G={selectRedmineState:T,selectIssues:V,selectVersions:L},Ee=e=>g(G.selectIssues,t=>t.find(s=>s.id===e));export{p as a,ne as b,a as c,O as d,c as e,N as f,ee as g,G as h,Ee as i};
